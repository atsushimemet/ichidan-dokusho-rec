# タグ分類テーブルセットアップ手順

## 概要
書籍検索機能で使用するタグ分類システムのセットアップ手順です。

## 問題
現在、以下のエラーが発生しています：
- `tag_category_mappings`テーブルが存在しないため404エラー
- タグ分類機能が利用できない

## 解決手順

### 1. Supabaseダッシュボードでの実行

#### 方法1: SQL Editorを使用
1. Supabaseダッシュボードにログイン
2. SQL Editorを開く
3. `supabase/tag_categories.sql`の内容をコピー&ペースト
4. 実行ボタンをクリック

#### 方法2: ファイルアップロード
1. Supabaseダッシュボードにログイン
2. SQL Editorを開く
3. `supabase/tag_categories.sql`ファイルをアップロード
4. 実行ボタンをクリック

### 2. Supabase CLIでの実行

```bash
# Supabase CLIがインストールされている場合
supabase db push
```

または

```bash
# 直接SQLファイルを実行
psql -h your-project.supabase.co -U postgres -d postgres -f supabase/tag_categories.sql
```

## 作成されるテーブル

### 1. tag_categories
- 大分類のマスターテーブル
- 10の分類（ジャンルタグ、知識・教養タグ、スキル・能力タグなど）

### 2. tag_category_mappings
- タグと分類のマッピングテーブル
- 各タグがどの分類に属するかを定義

## 分類一覧

1. **ジャンルタグ** - 書籍のジャンルを表すタグ
2. **知識・教養タグ** - 知識や教養に関連するタグ
3. **スキル・能力タグ** - スキルや能力向上に関連するタグ
4. **自己成長タグ** - 自己成長やメンタルヘルスに関連するタグ
5. **リラックス・娯楽タグ** - リラックスや娯楽に関連するタグ
6. **人物タグ** - 特定の人物に関連するタグ
7. **企業・組織タグ** - 企業や組織に関連するタグ
8. **技術・ITタグ** - 技術やITに関連するタグ
9. **社会・問題タグ** - 社会問題や社会現象に関連するタグ
10. **その他タグ** - その他の分類に属さないタグ

## 一時的な対処

現在のコードでは、タグ分類テーブルが存在しない場合でも従来の方法でタグが表示されるようになっています。

- **検索ページ**: ジャンルタグと著者別で表示
- **タグマスター管理ページ**: 従来の分類で表示

## 確認方法

セットアップ後、以下のURLでタグ分類が正常に表示されることを確認してください：

1. 書籍検索ページ: `/search`
2. タグマスター管理ページ: `/admin/tags`

## トラブルシューティング

### エラーが続く場合
1. Supabaseダッシュボードでテーブルが作成されているか確認
2. RLSポリシーが正しく設定されているか確認
3. 環境変数が正しく設定されているか確認

### 手動でテーブルを確認
```sql
-- テーブルの存在確認
SELECT * FROM tag_categories LIMIT 5;
SELECT * FROM tag_category_mappings LIMIT 5;
```
